
  <div class="ms-3">
    <div class="mt-3">
      <a href="javascript:history.back()" class="btn btn btn-secondary btn-sm">
        Go back
      </a>
    </div>
  </div>

<div class="container">
  <div class="row justify-content-center mt-5">
    <div class="col-md-8">
      <div class="card">
        <div class="card-header">
          The response
        </div>

        <div class="card-body" id="chat-messages">
<%= simple_format(@result) %>
        </div>

      </div>
    </div>
  </div>
</div>



</div>

<script>
$(document).ready(function() {
  $('#chat-form').submit(function(event) {
    event.preventDefault();

    // Get the user's message
    var userMessage = $('#user-message').val();

    // Clear the input field
    $('#user-message').val('');

    // Add the user's message to the chat interface
    $('#chat-messages').append('<div class="user-message">' + userMessage + '</div>');

    // Update the conversation history
    var conversationHistory = $('#conversation-history').val();
    conversationHistory += 'User: ' + userMessage + '\n';
    $('#conversation-history').val(conversationHistory);

    // Make an AJAX request to the ChatGPT API
    $.ajax({
      type: 'POST',
      url: '/gpt',
      data: { prompt: conversationHistory },
      dataType: 'json',
      success: function(response) {
            console.log('Response received:', response);
        var botMessage = response.bot_message;
        $('#chat-messages').append('<div class="bot-message">' + botMessage + '</div>');
      },
          error: function(xhr, status, error) {
    console.error('AJAX error:', error);
  }

        // Update the conversation history
          $('#chat-messages').append('<div class="bot-message">' + botMessage + '</div>');

    });
  });
});
</script>
